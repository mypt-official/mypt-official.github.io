---
layout: post
title:  "ğŸ“¦Databindingì„ ì“°ë©´ì„œ - 2"
date:   2022-07-10 18:00:00 +0900
categories: [í”„ë¡œê·¸ë˜ë°]
---
# ğŸ“¦Â Databindingì„ ì“°ë©´ì„œ - 2

ì´ë²ˆì—” 

- RecyclerView
- ViewPager
- image

ë“¤ì„ ì–´ë–»ê²Œ í•˜ë©´ Databindingì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ ì ì–´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ë³´í†µ RecyclerViewë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ 

- Adapter
- ë°˜ë³µë  Layout
- RecyclerViewë¥¼ ì‚¬ìš©í•˜ëŠ” ê³³ì—ì„œì˜ ì„ ì–¸

ë“¤ì´ í•„ìš”í•œë° Databindingì„ ì´ìš©í•˜ë©´ ì•½ê°„ì”© ë‹¬ë¼ì§€ê²Œ ëœë‹¤. (ê¸°ë³¸ì ì¸ RecyclerViewë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì „ì œí•˜ì— ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤ ğŸ™‡â€â™‚ï¸)

1. ê°€ì¥ ë¨¼ì € ë°˜ë³µí•˜ì—¬ ì‚¬ìš©í•  Layoutì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.

```kotlin
<?xml version="1.0" encoding="utf-8"?>
<layout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools">

    <data>
        <variable
            name="item"
            type="com.example.project.data.remote.response.kakao.local.AddressResponse" />

    </data>

    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@color/white">

        <TextView
            android:id="@+id/item_address"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginStart="20dp"
            android:layout_marginTop="15dp"
            android:fontFamily="@font/noto_medium"
            android:text="@{item.addressName}"
            android:textColor="@color/font_black"
            android:textSize="18sp"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintTop_toTopOf="parent"
            tools:text="@string/address" />

        <TextView
            android:id="@+id/item_road_address"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="15dp"
            android:fontFamily="@font/noto_regular"
            android:text="@{item.roadAddress.addressName}"
            android:textColor="@color/font_gray"
            app:layout_constraintBottom_toTopOf="@+id/view8"
            app:layout_constraintStart_toStartOf="@+id/item_address"
            app:layout_constraintTop_toBottomOf="@+id/item_address"
            tools:text="ë„ë¡œëª… ì£¼ì†Œ" />

        <View
            android:id="@+id/view8"
            android:layout_width="0dp"
            android:layout_height="1dp"
            android:background="@color/line_lightGray"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintStart_toStartOf="parent" />

    </androidx.constraintlayout.widget.ConstraintLayout>
</layout>
```

<img src="/images/2022-07-10_jacob.20.34.png" width="200px" height="500px" title="ì•„ì´í…œ ì‚¬ì§„" alt="ì•„ì´í…œ ì‚¬ì§„"/>


ìœ„ì™€ ê°™ì´ ë°”ì¸ë”©ìœ¼ë¡œ ë¬¶ì–´ì£¼ê³  ì‚¬ìš©í•  item(data class) ëª¨ë¸ì„ variableë¡œ ì„ ì–¸ í•´ì¤ë‹ˆë‹¤.

ì„ ì–¸í•œ itemìœ¼ë¡œ ê° Viewì— ë„£ì–´ì¤ë‹ˆë‹¤.

(ì¹´ì¹´ì˜¤ ì£¼ì†Œì°¾ê¸° apië¥¼ ì‚¬ìš©í•¨ ğŸ•ºğŸ¼)

1. Adapterë¥¼ ì„¸íŒ…í•´ì¤ë‹ˆë‹¤.

```kotlin
class FindAddressAdapter : RecyclerView.Adapter<FindAddressAdapter.MyViewHolder>() {
    var addressClick: AddressClick? = null // í´ë¦­ì‹œ ì´ë²¤íŠ¸ ë°œìƒì„ ìœ„í•œ listener
    var addressList: List<AddressResponse>? = listOf() // ì¶”í›„ bindingAdapterì—ì„œ ì¶”ê°€í•´ì£¼ê¸° ìœ„í•œ ë¹ˆ ë¦¬ìŠ¤íŠ¸

    override fun onBindViewHolder(holder: MyViewHolder, position: Int) {
        holder.bind(addressList?.get(position))
    }

    inner class MyViewHolder(
        val binding: ItemKakaoAddressBinding, 
        private val addressClick: AddressClick?
    ) : RecyclerView.ViewHolder(binding.root) {
        fun bind(get: AddressResponse?) {
            binding.item = get

            if (addressClick != null) {
                binding.root.setOnClickListener {
                    addressClick.selected(binding.item?.addressName)
                }
            }
        }
    }

    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): MyViewHolder {
        return MyViewHolder(
            ItemKakaoAddressBinding.inflate( // xmlì„ ë°”ì¸ë”©ìœ¼ë¡œ ë¬¶ì–´ì¤€ í›„ ì„ ì–¸
                LayoutInflater.from(parent.context), parent, false
            ), addressClick
        )
    }

    override fun getItemCount(): Int = addressList?.size ?: 0

    // ê¹œë°•ì„ ë°©ì§€
    override fun getItemId(position: Int): Long = position.toLong()

		// í´ë¦­ì‹œ ì´ë²¤íŠ¸ ë°œìƒì„ ìœ„í•œ listener
    interface AddressClick {
        fun selected(address: String?)
    }
}
```

1. bindingAdpaterì„ ë§Œë“¤ì–´ì¤€ë‹¤.
    
    ë§Œë“œëŠ” ì´ìœ  â†’ ê¸°ì¡´ì— Activityë‚˜ Fragmentì—ì„œ ì„¤ì •í•´ì£¼ë˜ ì½”ë“œë“¤ì„ ì´ ê³³ì—ì„œ ì„¤ì •í•œë‹¤.
    

```kotlin
object FindAddressBindingAdapter { // ì´ë¦„ì€ ì•„ë¬´ë ‡ê²Œë‚˜ ì„¤ì •í•´ë„ ìƒê´€X
    //region RecyclerView ê´€ë ¨
    @BindingAdapter("address") // í•´ë‹¹ ì´ë¦„ìœ¼ë¡œ xml ì½”ë“œì—ì„œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ í•¨ìˆ˜ëª…ê³¼ ê°™ê²Œ ì„¤ì •í•˜ë©´ ì•ˆ ëœë‹¤.
    @JvmStatic // BindingAdapter ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œ í•¨ìˆ˜ì˜ ê²½ìš° staticìœ¼ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì„ ì–¸
    fun setAddress(recyclerView: RecyclerView, items: List<AddressResponse>?) {
        if (recyclerView.adapter == null) {
            val adapter = FindAddressAdapter()
            adapter.setHasStableIds(true)   // ê¹œë°•ì„ ë°©ì§€
            recyclerView.adapter = adapter
        }

        val myAdapter = recyclerView.adapter as FindAddressAdapter

        items.let {
            myAdapter.addressList = it // ì—¬ê¸°ì„œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë„£ì–´ì¤€ë‹¤.
            myAdapter.notifyDataSetChanged() // ë¦¬ìŠ¤íŠ¸ë¥¼ ì¬ì„¤ì •í•˜ëŠ” ì½”ë“œ
        }
    }
}
```

1. RecyclerViewë¥¼ ì‚¬ìš©í•˜ëŠ” Layoutì—ì„œ bindingAdapterì„ ì„¤ì •í•œë‹¤.

```kotlin
<?xml version="1.0" encoding="utf-8"?>
<layout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools">

    <data>

        <import type="android.view.View" />

        <variable
            name="vm"
            type="com.work_guide.hwacha.viewModel.JoinViewModel" />
    </data>

    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        tools:context=".view.onBoarding.join.FindAddressFragment">

		...
<--  ì´ ë¶€ë¶„ì„ í™•ì¸í•˜ë©´ ëœë‹¤.-->
        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerView"
            android:layout_width="0dp"
            android:layout_height="0dp"
            android:layout_marginStart="20dp"
            android:layout_marginEnd="20dp"
            android:visibility="@{vm.getKaKaoAddress.data.meta.totalCount == 0 ? View.GONE : View.VISIBLE}"
            app:address="@{vm.getKaKaoAddress.data.documents}" <- bindingAdapter ì‚¬ìš©
            app:layoutManager="androidx.recyclerview.widget.LinearLayoutManager" <- ì´ ì½”ë“œë„ ê¼­ ë„£ì–´ì¤˜ì•¼ í•œë‹¤.(ì•„ë‹ˆë©´ Activityë‚˜ Fragmentì—ì„œ ì„ ì–¸í•´ì¤˜ì•¼í•œë‹¤. ê·¼ë° êµ³ì´?...)
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintHorizontal_bias="0.0"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintTop_toBottomOf="@+id/et_find_address"
            app:layout_constraintVertical_bias="0.0"
            tools:listitem="@layout/item_kakao_address" />
<--  ìš”ê¸°ê¹Œì§€~ -->

		...

    </androidx.constraintlayout.widget.ConstraintLayout>
</layout>
```

ìœ„ê¹Œì§€ ì„¤ì •í•œë‹¤ë©´ ëì´ë‚œë‹¤.

1. ClickListenerë¥¼ ë‹¬ì•„ì•¼í•œë‹¤ë©´ ì—¬ê¸°ê¹Œì§€ ì§„í–‰í•˜ë©´ ëœë‹¤.

```kotlin
class FindAddressFragment : Fragment(), FindAddressAdapter.AddressClick {
    private lateinit var binding: FragmentFindAddressBinding
    private lateinit var navController: NavController
    private val viewModel: JoinViewModel by sharedViewModel()

    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        binding = FragmentFindAddressBinding.inflate(inflater, container, false).apply {
            lifecycleOwner = this@FindAddressFragment
            executePendingBindings()
        }
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        navController = Navigation.findNavController(view)
        binding.run {
            vm = viewModel

						// ì´ëŸ° ì‹ìœ¼ë¡œ ë¦¬ìŠ¤ë„ˆë¥¼ ì§ì ‘ ë„£ì–´ì¤€ë‹¤.
            (recyclerView.adapter as FindAddressAdapter).addressClick = this@FindAddressFragment
        }
    }

    override fun selected(address: String?) { // ìƒì† ë°›ì€ í›„ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
        viewModel.businessAddress.value = address
        navController.popBackStack()
    }

}
```

ì´ë ‡ê²Œ í•˜ë©´ RecyclerViewë¥¼ Databinding ì²˜ë¦¬í•´ì„œ View ì²˜ë¦¬ë¥¼ ë‹¤ë¥¸ ê³³ì—ì„œ ê°€ëŠ¥í•˜ê²Œ ë˜ì–´ Fragment(or Activity) ì½”ë“œê°€ ì§§ì•„ì§€ê²Œ ë˜ì–´ MVVM ì„±ì§ˆì„ ë”ìš± ì˜ ë„ì–´ì§€ê²Œ ëœë‹¤.

ViewPagerë„ ë˜‘ê°™ì´ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

â†’ 3ë²ˆ BindingAdapterì—ì„œ RecyclerViewë¡œ ì„ ì–¸í–ˆë˜ê±¸ ViewPager2ë¡œ ì„ ì–¸í•´ì£¼ë©´ ë˜‘ê°™ì´ ê°€ëŠ¥í•˜ë‹¤.(ViewPager2ê°€ ì•„ë‹Œ ViewPagerì„ ì‚¬ìš©í•œë‹¤ë©´ ê·¸ì— ë”°ë¥¸ ì½”ë“œë¥¼ ì„ ì–¸í•´ì£¼ë©´ ëœë‹¤. â†’ Adapterë„â€¦)

ğŸ†Â ì´ë²ˆì—” Imageë¥¼ ì„¤ì •í•˜ëŠ” ë²•ì„ ì•Œì•„ë³´ë„ë¡ í•˜ì ğŸ“¸

ì €ëŠ” Glideë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— Picassoë‚˜ ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ì½”ë“œë¥¼ ë³´ë©´ì„œ ê·¸ì— ë”°ë¥¸ ì½”ë“œë¥¼ ì ìš©ì‹œì¼œì£¼ë©´ ëœë‹¤.

1. bindingAdapterë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.

```kotlin
object JobBindingAdapter {
		...

    @BindingAdapter("imageUrl")
    @JvmStatic
    fun loadImage(view: ImageView, url: String?) {
        if (!url.isNullOrEmpty()) {
            Glide.with(view.context) // viewì— ìˆëŠ” context ì‚¬ìš©.
                .load(url) // ì—¬ê¸°ì— ì¶”ê°€í•´ì£¼ê³ .
                .transform(MultiTransformation(CenterCrop(), RoundedCorners(5.dp))) // ì´ë¯¸ì§€ ì»¤ìŠ¤í…€ êµ¬ê°„.(ê°€ìš´ë°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ 1:1 ë¹„ìœ¨ì— ë§ì¶”ê¸° / ì½”ë„ˆë¥¼ 5dp ë§Œí¼ ë‘¥ê¸€ê²Œ)
                .into(view) // viewì— ë„£ì–´ì¤€ë‹¤.
        }
    }

		...
}
```

1. ì‹¤ì œ layoutì—ì„œ ì‚¬ìš©í•œë‹¤.

```kotlin
<?xml version="1.0" encoding="utf-8"?>
<layout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools">

    <data>

        <import type="android.text.Html" />

        <import type="android.view.View" />

        <variable
            name="vm"
            type="com.work_guide.hwacha.viewModel.JobViewModel" />
    </data>

    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        tools:context=".view.main.search.SearchDetailFragment">

				       ...

                <ImageView
                    android:id="@+id/imageView6"
                    android:layout_width="28dp"
                    android:layout_height="28dp"
                    android:layout_marginTop="20dp"
                    android:contentDescription="@string/reference_image"
                    app:imageUrl="@{vm.jobDetailResponse.data.brandImage}" <- ì´ ë¶€ë¶„ì„ ì£¼ëª©í•˜ì.
                    app:layout_constraintStart_toStartOf="@+id/guideline4"
                    app:layout_constraintTop_toBottomOf="@+id/textView46"
                    app:srcCompat="@drawable/icon_x_gray" />

                ... 

    </androidx.constraintlayout.widget.ConstraintLayout>
</layout>
```

ì´ëŸ¬ë©´ ëì´ë‹¤! ë„ˆë¬´ ê°„ë‹¨í•˜ì§€ ì•Šì€ê°€?

ë”°ë¡œ Activity, Fragment ë˜ Adapterì—ì„œ(RecyclerViewì—ì„œ ì‚¬ìš©í•  ë•Œ) ì„ ì–¸ì„ í•´ì£¼ì§€ ì•Šì•„ë„ viewì—ì„œ ê´€ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤.

ì˜¤íˆë ¤ ì´ê²Œ ë¶ˆí¸í•˜ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. ì½”ë“œë¥¼ ì“°ëŠ”ê±´ ê°œë°œì ë§ˆìŒì´ë‹¤. í•˜ì§€ë§Œ ìœ ì§€ ë³´ìˆ˜(ë¯¸ë˜ì˜ ë‚˜ì—ê²Œâ€¦)ë¥¼ ìœ„í•´ ê°ê° ê´€ë¦¬í•˜ëŠ” ê³³ì´ ì •í™•í•˜ê²Œ ë‚˜ë‰˜ì–´ì ¸ ìˆìœ¼ë©´ ì •ë§ í¸í•´ì§ˆ ê²ƒì´ë‹¤. 

í˜„ì¬ AndroidëŠ” Composeë¥¼ ë” ë°€ë©´ì„œ ê³„ì†í•´ì„œ ê°œë°œì´ ë˜ê³  í° ê¸°ì—…ì—ì„œë„ ë¶€ë¶„ì ìœ¼ë¡œ ë˜ëŠ” ì „ë©´ì„ Composeë¥¼ ì‚¬ìš©í•´ì„œ ë” MVí˜•íƒœ(Model, View)ì˜ êµ¬ì¡°ë¥¼ ë§Œë“¤ì–´ê°€ëŠ” ê²ƒìœ¼ë¡œ ì•Œê³ ìˆë‹¤. ê·¸ ì „ì— ì´ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ë„˜ì–´ê°€ê¸° ì „ì— ì‚¬ìš©í•´ë³´ëŠ” ê²ƒë„ ì¢‹ì„ ê²ƒ ê°™ë‹¤.

âŒÂ **Error**ë„ ì—„ì²­ ë§ì´ ë°›ì•„ë´¤ë‹¤.

(ê³„ì†í•´ì„œ ì¶”ê°€í•  ì˜ˆì •)

```
RequiredÂ DataBindingComponentÂ isÂ nullÂ inÂ classÂ ActivityMainBindingImpl
```

ìœ„ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë‚˜íƒ€ë‚  ê²½ìš°ê°€ ìˆë‹¤. 

BindingAdapter ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œ í•¨ìˆ˜ì˜ ê²½ìš°staticìœ¼ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•´ì•¼ í•œë‹¤. 

@JvmStaticì„ ì‚¬ìš©í•˜ê±°ë‚˜ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ë©´ ëœë‹¤. 

ì½”í‹€ë¦°ì—ì„œëŠ” í´ë˜ìŠ¤ ë‚´ë¶€ê°€ ì•„ë‹Œ ë°”ë¡œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê²Œ ë  ê²½ìš°, staticìœ¼ë¡œ ì„ ì–¸í•œ ê²ƒì´ ëœë‹¤.