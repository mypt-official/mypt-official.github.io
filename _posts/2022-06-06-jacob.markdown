---
layout: post
title:  "Kotlin ì½”ë“œë¥¼ ë³´ë‹¤ ê¹”ë”í•˜ê²Œ ë§Œë“¤ê¸°"
date:   2022-06-06 10:46:00 +0900
categories: [í”„ë¡œê·¸ë˜ë°]
---

# Kotlin ì½”ë“œë¥¼ ë³´ë‹¤ ê¹”ë”í•˜ê²Œ ë§Œë“¤ê¸°

ì½”í‹€ë¦°ì˜ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë‹¤ì–‘í•œ ê¸°ëŠ¥ ê³¼ í¸ë¦¬í•œ ê¸°ëŠ¥ìœ¼ë¡œ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì„ ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.

ê·¸ì¤‘ì—ì„œë„ **apply, with, let, also, run**ì™€ ê°™ì€ ë²”ìœ„ ì§€ì • í•¨ìˆ˜ë“¤ì´ ìˆìŠµë‹ˆë‹¤.

ê° ê¸°ëŠ¥ë“¤ì´ ì–¼í• ë³´ë©´ ë¹„ìŠ·í•´ì„œ í—·ê°ˆë¦´ ìˆ˜ ìˆê³  ì‚¬ìš©í•˜ë©´ ë³´ë‹¤ ê¹”ë”í•˜ê²Œ ì½”ë“œë¥¼ ê´€ë¦¬ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë²”ìœ„ ì§€ì • í•¨ìˆ˜ ë€ íŠ¹ì • ê°ì²´ì— ëŒ€í•œ ì‘ì—…ì„ ë¸”ë¡ ì•ˆì— ë„£ì–´ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

ë¸”ë¡ì€ íŠ¹ì • ê°ì²´ì— ëŒ€í•´ í•  ì‘ì—…ì˜ ë²”ìœ„ê°€ ë˜ë©°, ë”°ë¼ì„œ ë²”ìœ„ ì§€ì • í•¨ìˆ˜ë¼ ë¶€ë¥¸ë‹¤.

ë‹¤ë¥¸ ë§ë¡œ ìˆ˜ì‹ ê°ì²´ ì§€ì • ëŒë‹¤(í•¨ìˆ˜) ë¼ê³ ë„ ë¶€ë¥¸ë‹¤. â†’ ìˆ˜ì‹ ê°ì²´ë¥¼ ëª…ì‹œí•˜ì§€ ì•Šê±°ë‚˜ itì„ í˜¸ì¶œí•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ ëŒë‹¤ ì•ˆì—ì„œ ìˆ˜ì‹ ê°ì²´ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.

ì´ê²ƒì´ ê°€ëŠ¥í•œ ì´ìœ ëŠ” ë¸”ë¡(block) ëŒë‹¤ì‹ì—ì„œ ìˆ˜ì‹ ê°ì²´ë¥¼ ëŒë‹¤ì˜ ì…ë ¥ íŒŒë¼ë¯¸í„° í˜¹ì€ ìˆ˜ì‹ ê°ì²´ë¡œ ì‚¬ìš©í•˜ì˜€ê¸° ë•Œë¬¸ì´ë‹¤.

ë¬´ìŠ¨ ë§ğŸ¤”ì¸ì§€ ëª¨ë¥´ê² ìœ¼ë‹ˆ ì•„ë˜ ì˜ˆì œë¥¼ ë³´ë©° í™•ì¸í•´ë³´ì(ì—¬ëŸ¬ë²ˆ ë³´ë‹¤ë³´ë©´ ë¬´ìŠ¨ ë§ì¸ì§€ ì•Œê²Œ ë˜ê² ì§€,,,?)

# **apply**

```kotlin
inline fun <T> T.apply(block: T.() -> Unit): T {
    block()
    return this
}
```

- ìˆ˜ì‹  ê°ì²´ì˜ ëŒë‹¤ ë‚´ë¶€ì—ì„œ ìˆ˜ì‹  ê°ì²´ì˜ í•¨ìˆ˜ë¥¼ ì‚¬ìš© â, ìˆ˜ì‹  ê°ì²´ ìì‹ ì„ ë‹¤ì‹œ ë°˜í™˜ í•˜ë ¤ëŠ” ê²½ìš° apply ì‚¬ìš©

ì‚¬ìš© ì˜ˆ)

```kotlin
Val Peter = Person().apply {
// applyì˜ ë¸”ë¡ì—ì„œëŠ” ì˜¤ì§ í”„ë¡œí¼í‹°ë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
	name = â€œPeterâ€
	age = 18
}

// ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´
val clark = Person()

clark.name = â€œclarkâ€
clark.age = 18
```

ì¥ì  â†’ clark ì´ë¼ëŠ” ë³€ìˆ˜ë¥¼ ê³„ì† í˜¸ì¶œí•˜ì§€ ì•Šì•„ë„ ëœë‹¤. ê°€ë…ì„± â¬†ï¸

# **let**

```kotlin
inline fun <T, R> T.let(block: (T) -> R): R {
    return block(this)
}
```

- run ê³¼ withì™€ ë¹„ìŠ·í•˜ë‹¤.
    - ë‹¤ë¥¸ì  â†’ ìˆ˜ì‹ ê°ì²´ì— ì ‘ê·¼í•  ë•Œ it.name ì‹ìœ¼ë¡œ ì ‘ê·¼í•´ì•¼í•œë‹¤.
    - ë‹¤ë¥¸ì 2 â†’ nullableí•œ ê°’ì„ ì²˜ë¦¬í•´ì•¼í•  ë•Œ ì‚¬ìš©
- ë¬¼ë¡  letì€ nullable í•˜ì§€ ì•Šì€ ëŒ€ìƒì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì‹¤ë¬´ì—ì„œëŠ” nullableí•œ ê°’ì´ ì•„ë‹ê²½ìš° runì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì .

ì‚¬ìš© ì˜ˆ)

```kotlin
// 1) ì§€ì •ëœ ê°’ì´ **nullì´ ì•„ë‹Œ ê²½ìš°ì— ì½”ë“œë¥¼ ì‹¤í–‰**í•´ì•¼ í•˜ëŠ” ê²½ìš°
getNullablePerson()?.let {

	// null ì´ ì•„ë‹ ë•Œë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤.
	promote(it)
}
	
// 2) Nullable ê°ì²´ë¥¼ ë‹¤ë¥¸ nullable ê°ì²´ë¡œ ë³€í™˜í•˜ëŠ” ê²½ìš°
val drivesLicence : Licence? = getNullablePerson()?.let {

	// nullable Personal ê°ì²´ë¥¼ nullable driversLicence ê°ì²´ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
	licenceService.getDriversLicence(it)
}
	
// 3) ë‹¨ì¼ ì§€ì—­ ë³€ìˆ˜ì˜ ë²”ìœ„ë¥¼ ì œí•œí•˜ëŠ” ê²½ìš°
val person : Person = getPerson()

getPersonDao().let { dao ->
	// ë³€ìˆ˜ dao ì˜ ë²”ìœ„ëŠ” ì´ ë¸”ë¡ ì•ˆìœ¼ë¡œ ì œí•œë©ë‹ˆë‹¤.
	dao.insert(person)
}

// letì„ ì•ˆ ì“°ë©´
// 1) 
val person : Person? = getPromotablePerson()

if (person != null){
	promte(person)
}

// 2) 
val driver : Person? = getDriver()

val driverLicence : Licence? = 
	if (driver == null) 
		null
	else	
		licenceService.getDriversLicence(it)

// 3) 
val person : Person = getPerson()

val personDao : PersonDao = getPersonDao()

personDao.insert(person)
```

# **with**

```kotlin
inline fun <T, R> with(receiver: T, block: T.() -> R): R {
    return receiver.block()
}
```

- withëŠ” ìˆ˜ì‹ ê°ì²´ì— ëŒ€í•œ ì‘ì—… í›„ ë§ˆì§€ë§‰ ë¼ì¸ì„ return í•œë‹¤.
- run ê³¼ ì™„ì „ ë˜‘ê°™ì´ ë™ì‘!
    - ë‹¤ë¥¸ì  â†’ runì€ í™•ì¥í•¨ìˆ˜, withëŠ” ìˆ˜ì‹ ê°ì²´ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ ì‚¬ìš©í•´ì•¼í•¨.
    - run ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ í›¨ì”¬ ê¹”ë”í•˜ë¯€ë¡œ ì‹¤ì œë¡œëŠ” ê±°ì˜ ì‚¬ìš© â
- Non-nullable ìˆ˜ì‹  ê°ì²´ì´ê³  ê²°ê³¼ê°€ í•„ìš”í•˜ì§€ ì•Šì€ ê²½ìš°ì—ë§Œ withë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì‚¬ìš© ì˜ˆ)

```kotlin
val person : Person = getPerson()

with(person) {
	print(name)
	print(age)
}

// ì•ˆ ì“°ë©´
val person : Person = getPerson()

print(person.name)
print(person.age)
```

# **run**

```kotlin
inline fun <T, R> T.run(block: T.() -> R): R {
    return block()
}
```

- run ì€ apply ì™€ ë˜‘ê°™ì´ ë™ì‘
    - BUT ìˆ˜ì‹ ê°ì²´ return â
    - run ë¸”ë¡ì˜ ë§ˆì§€ë§‰ ë¼ì¸ì„ return í•œë‹¤.
    - ìˆ˜ì‹ ê°ì²´ì— ëŒ€í•´ íŠ¹ì •í•œ ë™ì‘ì„ ìˆ˜í–‰í•œ í›„ ê²°ê³¼ê°’ì„ ë¦¬í„´ ë°›ì•„ì•¼ í•  ê²½ìš° ì‚¬ìš©
- ì–´ë–¤ ê°’ì„ ê³„ì‚°í•  í•„ìš”ê°€ ìˆê±°ë‚˜ ì—¬ëŸ¬ê°œì˜ ì§€ì—­ ë³€ìˆ˜ì˜ ë²”ìœ„ë¥¼ ì œí•œí•˜ë ¤ë©´ runì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ë§¤ê°œ ë³€ìˆ˜ë¡œ ì „ë‹¬ëœ ëª…ì‹œì  ìˆ˜ì‹ ê°ì²´ë¥¼ ì•”ì‹œì  ìˆ˜ì‹  ê°ì²´ë¡œ ë³€í™˜í•  ë•Œ run()ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‚¬ìš© ì˜ˆ)

```kotlin
data class Person(
	var name: String = "",
	var age: Int = 0,
	var temperature: Float = 36.5f
) {
	fun isSick(): Boolean = temperature > 37.4f
}

fun main() {
	val person: Person = Person(name = "Jacob", age = 29, temperature = 36.5f)
	val isPersonSick = person.run {
		temperature = 37.6f
		isSick() // return ê°’
	}

	print("isPersonSick = $isPersonSick")
}
```

# **also**

```kotlin
inline fun <T> T.also(block: (T) -> Unit): T {
    block(this)
    return this
}
```

- applyì™€ ë§ˆì°¬ê°€ì§€ë¡œ ìˆ˜ì‹ ê°ì²´ ìì‹ ì„ ë°˜í™˜
    - ë‚´ë¶€ ìˆ˜ì‹ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” itì„ ì‚¬ìš©í•´ì•¼í•¨.
    - ë¸”ë¡ í•¨ìˆ˜ê°€ ë‹¤ë¥¸ ê°’ì„ ë°˜í™˜ í•´ì•¼í•˜ëŠ” ê²½ìš°ì—ëŠ” alsoë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
- ìˆ˜ì‹  ê°ì²´ ëŒë‹¤ê°€ ì „ë‹¬ëœ ìˆ˜ì‹  ê°ì²´ë¥¼ ì „í˜€ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜ ìˆ˜ì‹  ê°ì²´ì˜ ì†ì„±ì„ ë³€ê²½í•˜ì§€ ì•Šê³  ì‚¬ìš©í•˜ëŠ” ê²½ìš° alsoë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ìë©´, ê°ì²´ì˜ ì‚¬ì´ë“œ ì´íŒ©íŠ¸ë¥¼ í™•ì¸í•˜ê±°ë‚˜ ìˆ˜ì‹  ê°ì²´ì˜ í”„ë¡œí¼í‹°ì— ë°ì´í„°ë¥¼ í• ë‹¹í•˜ê¸° ì „ì— í•´ë‹¹ ë°ì´í„°ì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•  ë•Œ ë§¤ìš° ìœ ìš©í•©ë‹ˆë‹¤
- ì—¬ëŸ¬ ë¬¸ì œë¡œ also ëŠ” ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
    - ì‚¬ìš©í•  ë•ŒëŠ” í”„ë¡œí¼í‹°ë¥¼ ë°”ê¾¸ì§€ ì•Šê³  ë™ì‘ì„ ì¶”ê°€ì ìœ¼ë¡œ í•´ì•¼í•˜ëŠ” ê²½ìš°(ë¡œê¹… ë“±â€¦)ì—ì„œë§Œ ê°€~~ë” ì‚¬ìš©ëœë‹¤.

ì‚¬ìš© ì˜ˆ)

```kotlin
class Book(author : Person) {

	val author = author.also {
		requiresNotNull(it.age)
		print(it.name)
	}
}

// ì•ˆ ì“°ë©´
class Book(val author : Person) {

	init{
		requireNotNull(author.age)
		print(author.name)
	}
}
```

# ìœ„ ê¸°ëŠ¥ì„ ì‚¬ìš©ì‹œ ìœ ì˜í•  ì 

- ì¤‘ì²©ì´ ê°€ëŠ¥í•˜ì§€ë§Œ ê°€ë…ì„± â¬‡ï¸,  íŒŒì•… ğŸ˜” ( ì›ì¹™ì ìœ¼ë¡œëŠ” ì¤‘ì²© X)
- apply, run, withëŠ” ì¤‘ì²©í•˜ì§€ë§ˆì„¸ìš”(ì´ìœ  : this ì´ë¦„ì„ ë‹¤ë¥´ê²Œ ì§€ì •í•  ìˆ˜ ì—†ê¸°ì— í˜¼ë™í•˜ê¸° ì‰¬ì›€)
- alsoì™€ letì„ ì¤‘ì²© í•´ì•¼ë§Œ í•  ë•ŒëŠ” ì•”ì‹œì  ìˆ˜ì‹  ê°ì²´ë¥¼ ê°€ë¥´í‚¤ëŠ” ë§¤ê°œ ë³€ìˆ˜ì¸ itì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ëŒ€ì‹  ëª…ì‹œì ì¸ ì´ë¦„ì„ ì œê³µí•˜ì—¬ ì½”ë“œìƒì˜ ì´ë¦„ì´ í˜¼ë™ë˜ì§€ ì•Šë„ë¡ í•´ì•¼í•©ë‹ˆë‹¤.
- But ì¤‘ì²©ê³¼ ì—°ë™ì€ ë‹¤ë¥´ë‹¤ chain

ì—°ë™ ì˜ˆ)

```kotlin
private fun insert(user : User) = SqlBuilder().apply {

	append(â€œinsert into user (email, name, age) Values â€œ)
	append(â€œ (?â€, user.email)
	append(â€œÂ  ,?â€, user.name)
	append(â€œ ,?)â€, user.age)

}.also {
	print(â€œExecuting SQL update: $it.â€)
}.run {
	jdbc.update(this) > 0
}
```

ì•„ë˜ ì‚¬ì§„ì€ ê° ì½”ë“œì˜ êµ¬í˜„ ë°©ì‹ê³¼ ì˜ˆë¥¼ ì‚¬ì§„ìœ¼ë¡œ ì •ë¦¬ í•´ë‘” ê²ƒì´ê¸°ì— ê¸°ì–µì´ ë‚˜ì§€ ì•Šì„ ë•Œ í•œ ë²ˆì”© ë“¤ì—¬ë‹¤ ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

<img src="/images/2022_06_06_01_jacob.png" width="750px" height="600px" title="ë°ì´í„° ì‹œê°í™”" alt="ë°ì´í„° ì‹œê°í™”"/>

ì¶œì²˜ : [https://medium.com/@limgyumin/ì½”í‹€ë¦°-ì˜-apply-with-let-also-run-ì€-ì–¸ì œ-ì‚¬ìš©í•˜ëŠ”ê°€-4a517292df29](https://medium.com/@limgyumin/%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%9D%98-apply-with-let-also-run-%EC%9D%80-%EC%96%B8%EC%A0%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B0%80-4a517292df29)
